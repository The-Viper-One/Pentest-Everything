# Spray

The spray module provides different password spraying techniques. PsMapExec takes into account the default domain policy's account lockout threshold to prevent user account lockouts. However, it does not consider fine-grained password policies. It's advisable to assess whether such policies are in place within the environment to avoid potentially locking out a significant number of user accounts.

<figure><img src="../.gitbook/assets/image (559).png" alt=""><figcaption></figcaption></figure>

## Usage

### Hash

Hash authentication supports both RC4 / NT and AES256 hashes.

```powershell
PsMapExec -Method Spray -Hash [RC4]
PsMapExec -Method Spray -Hash [AES256]
```

### Password

```powershell
PsMapExec -Method Spray -Password [Password]
```

### AccountAsPasswords

Sets the password to the username value. This switch will also attempt to authenticate as computer accounts to identify any that might be current or legacy Pre-Windows 2000 Compatible Computers.

```powershell
PsMapExec -Method Spray -AccountAsPassword
```

### EmptyPassword

Authentication attempts are performed with empty password values.

```powershell
PsMapExec -Method Spray -EmptyPassword
```

### SuccessOnly

Displays only successful authentication attempts.

```
PsMapExec -Method Spray -Password Password123! -SuccessOnly
```

## To Do

* Add checking for Badpwdcount to identity if an issued password or hash does not increase the badpwdcount value but authentication was unsuccessful. In these instances this shows that the password or hash values was previously valid for the account.
* Add threading to increase the overall speed
* Ensure output to file is well formed into groups rather than "raw"
* Allow -Targets to accept values such as "Domain Admins" so we target only specific group members
