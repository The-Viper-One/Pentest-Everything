# Methods

PsMapExec currently supports the following methods for command execution

* MSSQL (In development)
* SMB
* RDP
* WinRM
* WMI

### Command Execution

All currently supported methods support the `-Command` parameter except for RDP. When the Command parameter is not specified access is simply checked for the specified method.

{% code overflow="wrap" %}
```powershell
PsMapExec -Username [User] -Password [Password] -Targets [Targets] -Method WMI -Command "net user"
```
{% endcode %}

<figure><img src="../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

## Syntax

General Example:

```powershell
PsMapExec -Targets Servers -Method WMI -Username User -Password Password123
```

### SMB

With Password

```powershell
PsMapExec -Username [User] -Password [Password] -Targets [Targets] -Method SMB
```

With Hash

```powershell
# RC4 / NT hash
PsMapExec -Username [User] -Hash [RC4] -Targets [Targets] -Method SMB

# Aes256 HMAC
PsMapExec -Username [User] -Hash [AES256] -Targets [Targets] -Method SMB
```

With Ticket

```powershell
PsMapExec -Ticket "[doIhdk..]" -Targets [Targets] -Method SMB
```

Current user context

```
PsMapExec -CurrentUser -Targets [Targets] -Method SMB
```

<figure><img src="../.gitbook/assets/image (2103).png" alt=""><figcaption></figcaption></figure>

### RDP

With Password

```powershell
PsMapExec -Username [User] -Password [Password] -Targets [Targets] -Method RDP
```

<figure><img src="../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

### WinRM

With Password

```powershell
PsMapExec -Username [User] -Password [Password] -Targets [Targets] -Method WinRM
```

With Hash

```powershell
# RC4 / NT hash
PsMapExec -Username [User] -Hash [RC4] -Targets [Targets] -Method WinRM

# Aes256 HMAC
PsMapExec -Username [User] -Hash [AES256] -Targets [Targets] -Method WinRM
```

With Ticket

```powershell
PsMapExec -Ticket [doIhdk..] -Targets [Targets] -Method WinRM
```

Current user context

```
PsMapExec -CurrentUser -Targets [Targets] -Method WinRM
```

<figure><img src="../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

### WMI

With Password

```powershell
PsMapExec -Username [User] -Password [Password] -Targets [Targets] -Method WMI
```

With Hash

```powershell
# RC4 / NT hash
PsMapExec -Username [User] -Hash [RC4] -Targets [Targets] -Method WMI

# Aes256 HMAC
PsMapExec -Username [User] -Hash [AES256] -Targets [Targets] -Method WMI
```

With Ticket (Base64) or path to file

```powershell
PsMapExec -Ticket [doIhdk..] -Targets [Targets] -Method WMI
```

Current user context

```
PsMapExec -CurrentUser -Targets [Targets] -Method WMI
```

With local account (Password only)

```
PsMapExec -Username [User] -Password [Password] -Targets [Targets] -Method WMI -LocalAuth
```

<figure><img src="../.gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure>

